(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc4935b6","chunk-02830d84","chunk-28cacdde","chunk-31fdc94d","chunk-2d22d9c7","chunk-2d0c53b3"],{"0995":function(e,t,n){},1794:function(e,t,n){},"2f88":function(e,t,n){"use strict";var r=n("f1d2"),a=n.n(r);a.a},"3de1":function(e,t,n){"use strict";function r(e){var t=e.split("/"),n=t[4]+"/"+t[5];return n}n.r(t),n.d(t,"src",function(){return r})},"3f7d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[n("span",[e._v("编辑歌手")]),n("span",{staticClass:"back",on:{click:e.back}},[n("i",{staticClass:"iconfont icon-fanhui"}),e._v(" 返回 ")])]),n("el-divider"),n("div",{staticClass:"wrap"},[n("el-row",[n("el-col",{attrs:{lg:16,md:20,sm:24,xs:24}},[n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,"status-icon":"","label-width":"200px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"歌手名",prop:"name"}},[n("el-input",{attrs:{size:"medium",placeholder:"请填写"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"歌单封面"}},[n("upload-imgs",{ref:"uploadEle",attrs:{value:e.initData,multiple:!0,"max-num":1,"auto-upload":!0}})],1),n("el-form-item",{staticClass:"submit"},[n("el-button",{directives:[{name:"auth",rawName:"v-auth",value:{auth:"创建歌单",type:"disabled"},expression:"{auth:'创建歌单', type: 'disabled'}"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("提 交")]),n("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1)],1)],1)],1)},a=[],i=n("a34a"),o=n.n(i),s=n("e0ba"),l=n("f7dd"),u=n("3de1");function c(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,s,"next",e)}function s(e){c(i,r,a,o,s,"throw",e)}o(void 0)})}}var f={data:function(){return{form:{},initData:[],loading:!1,fileList:"",uploadUrl:"http://muscafe/index.php/cms/file",addSong:!1}},props:{editID:Number},components:{uploadImgs:s["default"]},methods:{submitForm:function(){var e=d(o.a.mark(function e(t){var n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.getValue();case 3:if(console.log(this.form),this.form.img&&this.form.name){e.next=7;break}return this.loading=!1,e.abrupt("return",this.$message.error("请完整填写"));case 7:return e.next=9,l["default"].editSinger(this.form);case 9:n=e.sent,0===n.error_code?(this.$message.success("".concat(n.msg)),this.back()):this.$message.error(n.data.msg),this.loading=!1;case 12:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),resetForm:function(e){this.$refs[e].resetFields()},back:function(){this.$emit("editClose")},getSinger:function(){var e=d(o.a.mark(function e(t){var n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["default"].getSinger(t);case 2:n=e.sent,this.form=n;case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getValue:function(){var e=d(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs["uploadEle"].getValue();case 2:if(t=e.sent,n=t[0].src,n){e.next=6;break}return e.abrupt("return");case 6:this.form.img=n;case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),doClear:function(){this.$refs["uploadEle"].clear()},initUpload:function(e){this.initData=[{id:"",src:"",display:e,img_id:""}]}},created:function(){var e=d(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getSinger(this.editID);case 2:this.initUpload(this.form.img),1==this.form.from&&(this.form.img=Object(u["src"])(this.form.img),console.log(this.form));case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){var e=d(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},h=f,p=(n("5b6f"),n("2877")),g=Object(p["a"])(h,r,a,!1,null,"35772042",null);t["default"]=g.exports},"455c":function(e,t,n){"use strict";var r=n("1794"),a=n.n(r);a.a},"5b6f":function(e,t,n){"use strict";var r=n("9832"),a=n.n(r);a.a},"6e10":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lin-table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"linTable",attrs:{stripe:"","row-key":"id",border:e.border,data:e.currentData,"highlight-current-row":!!e.highlightCurrentRow,"element-loading-text":e.loadingText,"element-loading-spinner":e.loadingIcon,"element-loading-background":e.loadingBG,"row-class-name":e.rowClassName},on:{"current-change":e.handleCurrentChange,"selection-change":e.handleSelectionChange,"select-all":e.selectAll,"row-click":e.rowClick}},[e.type?n("el-table-column",{attrs:{type:e.type,width:"55"}}):e._e(),e.index?n("el-table-column",{attrs:{type:e.index,index:e.currentIndex,width:"55"}}):e._e(),e._l(e.filterTableColumn,function(e){return n("el-table-column",{key:e.id,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":!0,filters:e.filters?e.filters:null,"filter-method":e.filterMethod?e.filterMethod:null,"column-key":e.filterMethod?e.prop:null,formatter:e.formatter?e.formatter:null,sortable:!!e.sortable&&e.sortable,fixed:!!e.fixed&&e.fixed,width:e.width?e.width:""}})}),e.operate.length>0?n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"175"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.operate,function(r,a){return n("el-button",{directives:[{name:"auth",rawName:"v-auth",value:{auth:r.auth?r.auth:"",type:"disabled"},expression:"{ auth: item.auth ? item.auth : '', type: 'disabled' }"}],key:a,attrs:{type:r.type,plain:"",size:"mini"},nativeOn:{click:function(n){return n.preventDefault(),n.stopPropagation(),e.buttonMethods(r.func,t.$index,t.row)}}},[e._v(e._s(r.name))])})}}],null,!1,206950486)}):e._e()],2),e.pagination?n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":e.pagination.pageSize?e.pagination.pageSize:10,total:e.pagination.pageTotal?e.pagination.pageTotal:null},on:{"current-change":e.currentChange}}):e._e()],1)},a=[];function i(e){return l(e)||s(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function l(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var u={props:{tableColumn:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},operate:{type:Array,default:function(){return[]}},customColumn:{type:Array,default:function(){return[]}},fixedLeftList:{type:Array,default:function(){return[]}},fixedRightList:{type:Array,default:function(){return[]}},type:{type:String,default:null},index:{index:String,default:""},highlightCurrentRow:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:String,default:""},loadingIcon:{type:String,default:"el-icon-loading"},loadingBG:{type:String,default:"rgba(255,255,255,0.5)"},pagination:{type:[Object,Boolean],default:!1},border:{type:Boolean,default:!1}},data:function(){return{filterTableColumn:[],currentPage:1,currentData:[],selectedTableData:[],currentRow:null,oldVal:[],oldKey:[],currentIndex:1,rowClassName:""}},created:function(){},beforeMount:function(){sessionStorage.setItem("selectedTableData",JSON.stringify([]))},methods:{buttonMethods:function(e,t,n){var r=this,a=this.$options.methods;a[e](r,t,n)},handleEdit:function(e,t,n){e.$emit("handleEdit",{index:t,row:n})},handleDelete:function(e,t,n){e.$emit("handleDelete",{index:t,row:n})},toggleSelection:function(e,t){var n=this;e?e.forEach(function(e){n.$refs.linTable.toggleRowSelection(e,t)}):this.$refs.linTable.clearSelection()},selectAll:function(e){this.oldKey=e.map(function(e){return e.key})},handleCurrentChange:function(e,t){this.currentRow=e,this.$emit("handleCurrentChange",{val:e,oldVal:t})},rowClick:function(e){if(this.oldKey.includes(e.key)){this.oldKey=this.oldKey.filter(function(t){return t!==e.key});var t=this.oldVal.filter(function(t){return t.key!==e.key});this.handleSelectionChange(t),this.toggleSelection(this.currentData.filter(function(t){return t.key===e.key}),!1)}else{this.oldKey.push(e.key);var n=this.oldVal.concat(e);this.handleSelectionChange(n),this.toggleSelection(this.currentData.filter(function(t){return t.key===e.key}))}if(this.currentOldRow&&this.currentOldRow.key===e.key)return this.$refs.linTable.setCurrentRow(),void(this.currentOldRow=null);this.currentOldRow=e},currentChange:function(e){var t=this,n=[];this.oldVal=[],this.currentPage=e,this.selectedTableData=JSON.parse(sessionStorage.getItem("selectedTableData")),this.currentData=this.tableData.filter(function(e,n){return n>=(t.currentPage-1)*t.pagination.pageSize&&n<t.currentPage*t.pagination.pageSize}),this.$emit("currentChange",e),this.selectedTableData.forEach(function(e){for(var r=0;r<t.currentData.length;r++)t.currentData[r].key===e.key&&(t.oldVal.push(t.currentData[r]),n.push(t.currentData[r]))}),this.$nextTick(function(){t.toggleSelection(n)}),this.currentIndex=(this.currentPage-1)*this.pagination.pageSize+1},handleSelectionChange:function(e){var t=e.map(function(e){return e.key}),n=this.oldVal.map(function(e){return e.key});if(this.selectedTableData=JSON.parse(sessionStorage.getItem("selectedTableData")),0===this.selectedTableData.length)return this.selectedTableData=this.selectedTableData.concat(e),this.$emit("selection-change",this.selectedTableData),this.oldVal=i(e),void sessionStorage.setItem("selectedTableData",JSON.stringify(this.selectedTableData));if(t.length<n.length){var r=n.filter(function(e){return!t.includes(e)});this.selectedTableData=this.selectedTableData.filter(function(e){return!r.includes(e.key)}),this.$emit("selection-change",this.selectedTableData)}else{var a=t.filter(function(e){return!n.includes(e)}),o=e.filter(function(e){return a.includes(e.key)});this.selectedTableData=this.selectedTableData.concat(o),this.$emit("selection-change",this.selectedTableData)}sessionStorage.setItem("selectedTableData",JSON.stringify(this.selectedTableData)),this.oldVal=i(e)}},watch:{fixedLeftList:{handler:function(){var e=this;this.filterTableColumn.map(function(t,n){return e.fixedLeftList.indexOf(t.label)>-1?e.$set(e.filterTableColumn[n],"fixed","left"):-1===e.fixedRightList.indexOf(t.label)&&e.$set(e.filterTableColumn[n],"fixed",!1),""})},deep:!0,immediate:!0},fixedRightList:{handler:function(){var e=this;this.filterTableColumn.map(function(t,n){return e.fixedRightList.indexOf(t.label)>-1?e.$set(e.filterTableColumn[n],"fixed","right"):-1===e.fixedLeftList.indexOf(t.label)&&e.$set(e.filterTableColumn[n],"fixed",!1),""})},deep:!0,immediate:!0},customColumn:{handler:function(e){e.length>1&&(this.filterTableColumn=this.tableColumn.filter(function(t){return e.indexOf(t.label)>-1}))},deep:!0},tableData:{handler:function(){var e=this;this.pagination&&this.pagination.pageSize?this.currentData=this.tableData.filter(function(t,n){return n<e.pagination.pageSize}):this.currentData=this.tableData},deep:!0,immediate:!0},tableColumn:{handler:function(){var e=this;this.customColumn.length>1?this.filterTableColumn=this.tableColumn.filter(function(t){return e.customColumn.indexOf(t.label)>-1}):this.filterTableColumn=this.tableColumn},deep:!0,immediate:!0}}},c=u,d=(n("d51e"),n("980e"),n("2877")),f=Object(d["a"])(c,r,a,!1,null,"38e69034",null);t["default"]=f.exports},"8eab":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lin-search"},[n("el-input",{staticClass:"input-with-select",attrs:{size:"medium",placeholder:e.placeholder,clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)},a=[],i=n("306b"),o={props:{placeholder:{type:String,default:"请输入内容"}},data:function(){return{keyword:""}},created:function(){var e=this;this.$watch("keyword",i["default"].debounce(function(t){e.$emit("query",t)},1e3))},methods:{clear:function(){this.keyword=""}}},s=o,l=(n("455c"),n("2877")),u=Object(l["a"])(s,r,a,!1,null,"3104290c",null);t["default"]=u.exports},"980e":function(e,t,n){"use strict";var r=n("cfa4"),a=n.n(r);a.a},9832:function(e,t,n){},cfa4:function(e,t,n){},d28c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.showEdit?e._e():n("div",{staticClass:"container"},[n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[e._v("歌曲列表")]),n("lin-search",{attrs:{placeholder:"请输入歌曲或者歌手关键字"},on:{query:e.onQueryChange}})],1),n("lin-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{tableColumn:e.tableColumn,tableData:e.tableData,operate:e.operate},on:{handleEdit:e.handleEdit,handleDelete:e.handleDelete,"row-click":e.rowClick}}),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:!0,"page-size":e.pageCount,"current-page":e.currentPage,layout:"prev, pager, next, jumper",total:e.total_nums},on:{"current-change":e.handleCurrentChange}})],1)],1),e.showEdit?n("SingerEdit",{attrs:{editID:e.editID},on:{editClose:e.editClose}}):e._e()],1)},a=[],i=n("a34a"),o=n.n(i),s=n("8eab"),l=n("f7dd"),u=n("6e10"),c=n("3f7d");function d(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){d(i,r,a,o,s,"next",e)}function s(e){d(i,r,a,o,s,"throw",e)}o(void 0)})}}var h={components:{LinTable:u["default"],LinSearch:s["default"],SingerEdit:c["default"]},data:function(){return{currentPage:1,pageCount:10,total_nums:0,searchKeyword:"",tableData:[],operate:[],showEdit:!1,editID:1,tableColumn:[{prop:"id",label:"id"},{prop:"name",label:"歌手"},{prop:"create_time",label:"创建时间"},{prop:"update_time",label:"更新时间"}]}},methods:{getsinger:function(){var e=f(o.a.mark(function e(t,n){var r,a;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,r={page:t,count:n,word:this.searchKeyword},e.prev=2,e.next=5,l["default"].getSingers(r);case 5:a=e.sent,this.tableData=a.data,this.currentPage=a.current_page,this.total_nums=a.total,this.loading=!1,e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),10020===e.t0.error_code&&(this.tableData=[],this.loading=!1);case 15:case"end":return e.stop()}},e,this,[[2,12]])}));function t(t,n){return e.apply(this,arguments)}return t}(),handleEdit:function(e){this.editID=e.row.id,this.showEdit=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该歌曲, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(f(o.a.mark(function n(){var r;return o.a.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,l["default"].delectSinger(e.row.id);case 2:r=n.sent,0===r.error_code&&(t.getsinger(t.currentPage,t.pageCount),t.$message({type:"success",message:"".concat(r.msg)}));case 4:case"end":return n.stop()}},n)})))},rowClick:function(){},editClose:function(){this.showEdit=!1,this.getsinger(this.currentPage,this.pageCount)},handleCurrentChange:function(){var e=f(o.a.mark(function e(t){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.currentPage=t,this.loading=!0,this.getsinger(this.currentPage,this.pageCount),this.loading=!1;case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),onQueryChange:function(e){var t=this;if(this.searchKeyword=e.trim(),!e)return this.searchKeyword="",void this.getsinger(this.currentPage,this.pageCount);this.loading=!0,setTimeout(function(){t.loading=!1,t.getsinger(t.currentPage,t.pageCount)},1e3)},statusFormat:function(e,t){}},created:function(){var e=f(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getsinger(this.currentPage,this.pageCount);case 2:this.operate=[{name:"编辑",func:"handleEdit",type:"primary"},{name:"删除",func:"handleDelete",type:"danger",auth:"删除歌单"}];case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},p=h,g=(n("2f88"),n("2877")),m=Object(g["a"])(p,r,a,!1,null,"601bdb78",null);t["default"]=m.exports},d51e:function(e,t,n){"use strict";var r=n("0995"),a=n.n(r);a.a},f1d2:function(e,t,n){},f7dd:function(e,t,n){"use strict";n.r(t);var r=n("a34a"),a=n.n(r),i=n("dfd8");function o(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,l,"next",e)}function l(e){o(i,r,a,s,l,"throw",e)}s(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var d=function(){function e(){l(this,e)}return c(e,[{key:"addSinger",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["post"])("v1/singer",t,{handleError:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSinger",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["get"])("v1/singer/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"editSinger",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["put"])("v1/singer",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"delectSinger",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["_delete"])("v1/singer/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSingers",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["get"])("v1/singer",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSingerInList",value:function(){var e=s(a.a.mark(function e(t){var n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["get"])("v1/singer/list/"+t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}();t["default"]=new d}}]);